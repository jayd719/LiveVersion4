{% extends 'hp/base.html' %} 
{% load static %} 
{% block content %}

<link rel="stylesheet" href="{% static 'worderTracker/tracker.css' %}" />

<div class="table-container" >
  <table class="table table-hover">
    <thead class="table-dark">
      <tr style="height: 50pt; font-weight: bold">
        <th scope="col" style="width: 125px;">WorkOrder</th>
        <th scope="col" style="width: 250px;">Customer</th>
        <th scope="col" style="width: 20px;">QTY</th>
        <th scope="col" style="width: 10px;">Due Date</th>
        <th scope="col" >Due In</th>
        <th >% Comp</th>
        <th style=" font-size: 80%">Shipping This Month</td>
        <th scope="col">TA</th>
        <th scope="col" style="min-width:200px;">Notes</th>
        <th >Incoming Inspection</th>
        <th>ME</th>
        <th >PR</th>
        <th >OPS</th>
        <th>ME</th>
        <th >PR</th>
        <th >OPS</th>
        <th>ME</th>
        <th >PR</th>
        <th >OPS</th>
        <th>ME</th>
        <th >PR</th>
        <th >OPS</th>

      </tr>
    </thead>

    <body class="table-group-divider">
      
  
    {%for WO in WORKORDERS%}
    <tr>
      <td class="jobNumbers" title="{{WO.des}}">{{WO.jobNumber}}</td>
      <td>{{WO.customer}}</td>
      <td>{{WO.qty}}</td>
      <td>{{WO.dueDate}}</td>
      <td id="due-in" class="">{{WO.dueDate}}</td>
      <td>20%</td>
      <td>
        <form method="post" action="{% url 'updateShippingThisMonth' %}">{% csrf_token %}
          <input type="hidden" name="jobNumber" value="{{WO.jobNumber}}" readonly />
          {% if WO.shippingThisMonth %}
          <input class="form-check-input" name="shippingThisMonth" type="checkbox" value="none" aria-label="..." onChange="this.form.submit()" checked>
          {% else %}
          <input class="form-check-input" name="shippingThisMonth" type="checkbox"  value="True" aria-label="..." onChange="this.form.submit()">
          {% endif%}
            
        </form>
      </td>
      <td class="pl-2 pr-2">{{WO.TA}}</td>
      <td>ETT</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
      <td style="padding-left: 20px; padding-right: 50px;">10</td>
    </tr>
    
    
    {% endfor%}
  </body>
  </table>
</div>

<script>
 
updateDate()



function updateDate(){
  let dates = document.querySelectorAll("#due-in")
  for(i=0;i<dates.length;i++){
    const targetDate = new Date(dates[i].textContent);
    const currentDate = new Date();
    const dueIn = Math.ceil((targetDate - currentDate) / (1000 * 60 * 60 * 24));
    dates[i].innerHTML= dueIn;
    if(dueIn<0){
      dates[i].style.backgroundColor = 'red'
      dates[i].style.color = 'white'
    }else if(dueIn>=0 && dueIn<=7){
      dates[i].style.backgroundColor = 'yellow'
    }else{
      dates[i].style.backgroundColor = 'green'
    }


  }

 
 
}

</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
{% endblock%}
